"""
#!/usr/bin/env python
# -*- coding: utf-8 -*-
@created by: Shivan
@created on: 5/10/2022 2:09 PM  
"""
import numpy as np
from matplotlib import pyplot as plt
import scipy.interpolate
import pandas as pd
import os

path = os.getcwd()
Foldername = "DataDocs"  # data folder name

x = np.array([0.5074278501996836,
              0.5460482442920654,
              0.6021654359128928,
              0.6859265503729939,
              0.7605860522944767,
              0.784638497475699,
              0.7760285585110391,
              0.7535387310677417,
              0.7158578856152513,
              0.6643621430186121,  #
              0.545443005758351,
              0.5609523521706526,
              0.5764620308507382,
              0.5919733708697428,
              0.6074840463531798,
              0.6229954694391303,
              0.6385077231945404,
              0.6540213890880318,
              0.6695353872493071,
              0.6850497683396686,
              0.7005637708089836,
              0.7160792108482135,
              0.7305374688129572,
              0.7858366448352612,
              0.8035546841166087,
              0.8190799073911806,
              0.8353125039068656,
              0.848729608952211,
              0.8586226533198604,
              0.8701099904757945,
              0.8664731643226823,
              0.8623424793029821,
              0.8531162688862555,
              0.8418500875551685,
              0.8284668848499208,
              0.813673982539786,
              0.7981739396254312,
              0.7826706571001842,  #
              0.5312996122053324,
              0.5468089586176341,
              0.5623194129116649,
              0.5930595241256235,
              0.609204296107366,
              0.6257724501545983,
              0.6398742575224452,
              0.6553880895498285,
              0.6709010742943631,
              0.6864146747016469,
              0.7019291536838594,
              0.7174430023246319,
              0.7322538221750092,
              0.7879742323985695,
              0.8030224883464542,
              0.8350970338405386,
              0.8514657880036637,
              0.8669883420603722,
              0.914087811201197,
              0.9290862004462341,
              0.9446144861222135,
              0.9621010178848564,
              0.9714544796171644,
              0.9778256894518248,
              0.9774239195543245,
              0.977156508068565,
              0.9672201746502085,
              0.9569700991390802,
              0.9480398652926941,
              0.9398635967487394,
              0.9293020439719447,
              0.9173295777580336,
              0.9032429604625751,  #
              0.470622032461408,
              0.4861309635389799,
              0.5016405591521195,
              0.5171506531669348,
              0.532660830248696,
              0.5481711734643492,
              0.5636822642825159,
              0.5791936873684665,
              0.5947048363334955,
              0.6130392314308626,
              0.6285516513201647,
              0.6440647357450343,
              0.6595788169732555,
              0.6750923997998008,
              0.6906058995594003,
              0.752522414495548,
              0.7681792961105604,
              0.7836957032132683,
              0.799212359516814,
              0.8147298464898193,
              0.8302477487975543,
              0.8457659003061272,
              0.8612853657084596,
              0.8768054277567895,
              0.957233268949175,
              0.9727566536753433,
              0.9882819489412683,
              1.003809902349464,
              1.0172215487921972,
              1.048293777741871,
              1.056358389064809,
              1.0544887830312466,
              1.0427836673873343,
              1.035045416516399,
              1.0090046599486482,
              1.0005555678410505,
              0.988583666548298,  #
              0.45505686506142456,
              0.470566709875402,
              0.48607672082327136,
              0.5015863164364109,
              0.5170991516604426,
              0.5326103587723339,
              0.5481207518281546,
              0.5636321749141051,
              0.5791444286695153,
              0.5946569095777059,
              0.6101690192472815,
              0.6256816883374213,
              0.6411945235614531,
              0.6552976019567016,
              0.7328678696528974,
              0.7483831138183619,
              0.7638980257160426,
              0.7794143497518045,
              0.7949299261850528,
              0.8104462502208146,
              0.8259626573235226,
              0.841480061229582,
              0.8569990434076143,
              0.8725165303806196,
              0.8880350972239224,
              0.9035539963350089,
              0.9190744737180685,
              0.981158542990902,
              0.9938579126221464,
              1.0333751728206937,
              1.048901631023862,
              1.061606115205636,
              1.1082024948056488,
              1.1174320483373195,
              1.1167484364455413,
              1.1132402825770682,
              1.1090292522076006,
              1.0900487715024043,
              1.080195168639217,
              1.0703401299045359,
              1.0611908872762204,
              1.0513352121893993,
              1.039364465757937,  #
              0.449344434255049,
              0.4648556912071077,
              0.4803666989583285,
              0.49587737444176544,
              0.5113882160590943,
              0.5268990576764232,
              0.5424106468962657,
              0.5579221530491623,
              0.5734341576037345,
              0.5889476573633339,
              0.6044607002547306,
              0.6199728294097218,
              0.6354858307676455,
              0.6510004934644884,
              0.6665145746927095,
              0.6820277421845251,
              0.6940174867187519,
              0.7144710331322559,
              0.729984948226585,
              0.7455011061284551,
              0.7610170148294872,
              0.7765330065974653,
              0.7920493306332272,
              0.8075661115371918,
              0.8230829755081025,
              0.8386002963472159,
              0.8541184478557888,
              0.8696361009626861,
              0.8851534218017993,
              0.900672071712048,
              0.9161898078858911,
              0.9712106947441758,
              0.9867308398594515,
              1.0022503204391597,
              1.0177707978222195,
              1.034229730118781,
              1.0493549316077815,
              1.0637465826208494,
              1.079856528433972,
              1.0953790824906806,
              1.1109026333507406,
              1.1264270148802602,
              1.1419519778784015,
              1.1574800143535429,
              1.1730103767031712,
              1.1878379511565478,
              1.2112024651662165,
              1.1964322512079202,
              1.1879882607952532,
              1.1788392792344822,
              1.168279194962625,
              1.1570143099044148,
              1.1457487395439006,
              1.1344825980981328,
              1.123216456652365,
              1.1112446568858796,
              1.099272907882528,
              1.0865957746793804,  #
              0.509917598847908,
              0.5254292711346964,
              0.5860683078156976,
              0.6015808107719457,
              0.6170933967951396,
              0.6326058166844417,
              0.6481192333770951,
              0.6636337299400461,
              0.6791475619674294,
              0.6946608955931368,
              0.7101747276205201,
              0.7256883935140115,
              0.7412023916752867,
              0.7567168051712916,
              0.7722313017342425,
              0.7877458813641394,
              0.8032612916634959,
              0.8187770342306361,
              0.8342933582663979,
              0.8498098484360518,
              0.8653269200743273,
              0.8752007556722077,
              0.934445929000085,
              0.9499627514375227,
              0.9654794077410684,
              0.9809965624462899,
              0.9965138832854032,
              1.0120316194592465,
              1.0275497709678194,
              1.043068337811122,
              1.0585881506586141,
              1.0741074651044302,
              1.0896270287510845,
              1.105147672268036,
              1.1206697279230688,
              1.1361921989128314,
              1.1517159159067836,
              1.1672407958379787,
              1.1827669217733634,
              1.1982944598468293,
              1.21382374232616,
              1.2293557660147072,
              1.2448914446488768,
              1.2565086102693557,
              1.2682111191211192,
              1.2752836673338246,
              1.2808083460756055,
              1.2839387547873546,
              1.2800815449097271,
              1.2755437624016512,
              1.267663725747336,
              1.247260057079309,
              1.238809251715951,
              1.2268375915480831,
              1.2134552822739875,
              1.2000731354419196,
              1.1859844368579822,
              1.1711902220901012,
              1.1563967383113445,
              1.1408973599325574,  #
              0.5606202505207247,
              0.576134165615054,
              0.5916486621780049,
              0.6071619127367665,
              0.6226752463624741,
              0.6381884969212356,
              0.6537027442833487,
              0.669218503463878,
              0.6850134215763309,
              0.7002439911646606,
              0.7157574909242601,
              0.7312714060185892,
              0.7467851549790266,
              0.7622993192741937,
              0.7778132343685229,
              0.7933272325297981,
              0.8088413137580193,
              0.8236500320146639,
              0.8793621604637126,
              0.8948768231605554,
              0.9103910705226684,
              0.925905982420349,
              0.9414211435188676,
              0.9569362215504402,
              0.9724516318497967,
              0.987967291349991,
              1.0034824524485095,
              1.0189982780825957,
              1.0345140206497359,
              1.0500309261541196,
              1.0655490776626926,
              1.081065983167076,
              1.096583968541757,
              1.1121022861842218,
              1.1276208530275245,
              1.1431400013394488,
              1.1586600633877788,
              1.1741808730386225,
              1.1897018488233577,
              1.2052244028800663,
              1.2207473722715045,
              1.2362714215332402,
              1.2517971321338952,
              1.267324504073469,
              1.2828515437452592,
              1.2983792479526168,
              1.3115615961686158,
              1.3223780665962659,
              1.3100596068777364,
              1.3026901126540866,
              1.2710356121476496,
              1.2589905724197314,
              1.2452520382612673,
              1.214655770919168,
              1.2043900784748947,
              ])

y = np.array([1.0573204732122674,
              1.1478204355361319,
              1.245825484138347,
              1.3330137141134808,
              1.2765692110617135,
              1.1442506216562434,
              0.9601311129530559,
              0.856879662421822,
              0.7424610051993072,
              0.6242483610880867,  #
              1.304764745964208,
              1.3341642425002938,
              1.3625430124044848,
              1.3858181491492043,
              1.4111347391577127,
              1.4341546942444587,
              1.4546228327514685,
              1.4707528830729277,
              1.4858622067624925,
              1.499795172298799,
              1.5148912616901495,
              1.525571136302609,
              1.533406729523436,
              1.5234581243697296,
              1.5095466974168779,
              1.490172473058945,
              1.4647527281436084,
              1.4205024755428715,
              1.3671412441135815,
              1.2161125670740445,
              1.087427281008412,
              1.0156395464678711,
              0.9467136150110327,
              0.8843414458362142,
              0.8244437096565078,
              0.7611330074061473,
              0.7031531651770195,
              0.6551254076088617,  #
              1.4131682179946896,
              1.4425677145307754,
              1.4685637983949296,
              1.5163634689112586,
              1.5440401846530925,
              1.571290240895648,
              1.5906395297122211,
              1.6062592167177328,
              1.6244817566345753,
              1.6408129805855622,
              1.6544452223557309,
              1.670013873029648,
              1.678281891655106,
              1.6985827001061842,
              1.6997820525703153,
              1.693275756671774,
              1.682980734049143,
              1.671806346967428,
              1.629825978840927,
              1.6036320861069977,
              1.5748501646251052,
              1.5303362649131111,
              1.468583041537471,
              1.399272114739779,
              1.3333061941753575,
              1.2879922479715957,
              1.1883199074089186,
              1.1157420021915976,
              1.052897535649989,
              1.0005467869426408,
              0.9405607751239109,
              0.8808906898429467,
              0.8148774986484804,  #
              1.4522566431069601,
              1.4829320479329136,
              1.5115659994950787,
              1.538668861109402,
              1.5655165410657517,
              1.5918538577061543,
              1.6158945394247943,
              1.6389144945115404,
              1.6627765490695996,
              1.6816467896530343,
              1.7016045648440972,
              1.7195208867713714,
              1.7343750288029625,
              1.7507602607823953,
              1.7674006744198014,
              1.8229124758530868,
              1.8324848448907074,
              1.8401939004990382,
              1.847137411133448,
              1.851529105188122,
              1.8546448909529278,
              1.8569951317438131,
              1.8553090909059775,
              1.8517901535634702,
              1.816040690757611,
              1.80231448709616,
              1.7827191053013163,
              1.754957910451318,
              1.7274764850752962,
              1.5867871212225066,
              1.4183925077125004,
              1.371466912867746,
              1.212830901930249,
              1.1476817398808277,
              0.9656980987519104,
              0.9172481395864458,
              0.8558426165061364,  #
              1.594339220729126,
              1.6222076273173702,
              1.6495656705896673,
              1.6781996221518323,
              1.6968814890530273,
              1.7205649164505044,
              1.746749124096123,
              1.7697690791828686,
              1.7902372176898786,
              1.8100075428548839,
              1.8309183130459252,
              1.8501105432630673,
              1.8687924101642623,
              1.8842371028036289,
              1.9589331157248737,
              1.9702147145448345,
              1.9825170399966896,
              1.9904812772629938,
              2.00074214945106,
              2.0087063867173645,
              2.0164154423256955,
              2.021062318038343,
              2.020860742249492,
              2.025252436304166,
              2.026326768805183,
              2.0263803746743063,
              2.0215855290419307,
              1.9957714234051165,
              1.9893992867806733,
              1.9446602208031114,
              1.9214922957966376,
              1.8994082599455349,
              1.7776651540866635,
              1.5955426946421214,
              1.5285933500423357,
              1.4706166532815617,
              1.4048714914327098,
              1.2037711619584153,
              1.1359680916793384,
              1.0725760186309476,
              1.0079833829682388,
              0.9465461836925386,
              0.881592926728457,  #
              1.8068860487778085,
              1.8304163671805016,
              1.8547122305571153,
              1.8800288205656235,
              1.9048350472581845,
              1.9296412739507456,
              1.9521508657215445,
              1.9749156391503166,
              1.9961493226312477,
              2.0127897362686538,
              2.0308336490249146,
              2.0516845600188853,
              2.0698560636041328,
              2.0829239340299086,
              2.0977780760615,
              2.1154392163308007,
              2.1220303016025053,
              2.131882927440185,
              2.147247432787723,
              2.155722033369975,
              2.164962178926147,
              2.1739471428243458,
              2.18191138009065,
              2.1884721182380993,
              2.1947776747275753,
              2.199679732098196,
              2.2020299728890813,
              2.205911303627808,
              2.2108133609984293,
              2.211632511841473,
              2.2152586609222262,
              2.2174901713583597,
              2.2137160523578787,
              2.2119833866211867,
              2.2071885409888115,
              2.2088003026010727,
              2.195879883643686,
              2.1860751015269804,
              2.1762708021925254,
              2.16509641511081,
              2.150859848133412,
              2.1340714645762784,
              2.115496809413329,
              2.087480432905357,
              2.052318969974125,
              2.00911684818631,
              1.7444973231739906,
              1.6114880040757766,
              1.5473656380831007,
              1.4819710029239033,
              1.4174737439374265,
              1.351119424484905,
              1.286870353710666,
              1.2243756568349953,
              1.1618809599593245,
              1.100163548185936,
              1.0382901920660084,
              0.9763520215770503,  #
              2.0885609677383394,
              2.1108153778511642,
              2.1901312420386394,
              2.209833835571729,
              2.229281247446844,
              2.2492390226379073,
              2.266134617933287,
              2.27971285167501,
              2.2953325386805217,
              2.3124833156338753,
              2.328103002639387,
              2.3442330529608464,
              2.359342376650411,
              2.3731757920501075,
              2.3867540257918307,
              2.4000770778755802,
              2.410848313379594,
              2.420598822251713,
              2.4285630595180177,
              2.4360169334683746,
              2.4416845358129162,
              2.4473326451141406,
              2.4745865778141742,
              2.481019725132637,
              2.4879632357670465,
              2.493375656453615,
              2.498277713824236,
              2.5019038629049892,
              2.5042541036958745,
              2.5053284361968915,
              2.502575043828305,
              2.50135274140756,
              2.4993648940128943,
              2.4940596850645718,
              2.4844163879306986,
              2.473497182506957,
              2.458750252213612,
              2.4404307787086363,
              2.418283580334057,
              2.3917982937739266,
              2.359954192396351,
              2.319689096305647,
              2.268196007264105,
              2.2102124597316,
              2.141323541225929,
              2.0845061932164586,
              2.0153326923741544,
              1.93353946490616,
              1.792126787657819,
              1.718895160080882,
              1.6559109093458964,
              1.4928338494025988,
              1.4496470119328395,
              1.3875007532064678,
              1.3248583965276677,
              1.261717017939941,
              1.202097544953591,
              1.1428187128992122,
              1.081294282254667,
              1.0212729867617503,  #
              2.354380511078702,
              2.369745016426241,
              2.3833232501679635,
              2.400729208779291,
              2.417879985732644,
              2.435285944343971,
              2.4496297230596147,
              2.459329195600139,
              2.478254459728575,
              2.497254329050071,
              2.5138947426874774,
              2.5292592480350153,
              2.545134116698501,
              2.5597330770721185,
              2.575097582419657,
              2.5902069061092217,
              2.6050610481408123,
              2.619785162713002,
              2.665527582464047,
              2.6785954528898235,
              2.692939231605467,
              2.7052415570573225,
              2.7167783375352568,
              2.7285702996711647,
              2.7393415351751784,
              2.7493472257052716,
              2.760884006183206,
              2.7703793333973517,
              2.7801298422694707,
              2.7863078079299597,
              2.788658048720845,
              2.794836014381334,
              2.7976966184881666,
              2.7995364959631046,
              2.800610828464122,
              2.799898889359324,
              2.796379952016817,
              2.790564379752547,
              2.7842384441723302,
              2.773064057090615,
              2.7606137617190325,
              2.7448461047937927,
              2.7239748147090816,
              2.697999891464898,
              2.6730456948526093,
              2.646050044976532,
              2.623988000553847,
              2.599851760519698,
              1.436068645284003,
              1.4030736820635457,
              1.2656992378356557,
              1.2122744799705547,
              1.1604524300007557,
              1.0422509696140736,
              1.002098477493079,
              ])

z = np.array(
    [0.94] * 10 + [0.93] * 28 + [0.92] * 33 + [0.91] * 37 + [0.9] * 43 + [0.89] * 58 + [0.88] * 60 + [0.87] * 55)

filename = "Smith_fletcher"
SmithC_fletcher = pd.read_excel(path + "\\" + Foldername + "\\" + filename + ".xlsx", index_col=False)

x = SmithC_fletcher['x']
y = SmithC_fletcher['y']
z = SmithC_fletcher['z']

# Interpolate
xm = np.linspace(0.2, 1.55, 100)
ym = np.linspace(0.5, 3, 100)
xi, yi = np.meshgrid(xm, ym)
rbf = scipy.interpolate.Rbf(x, y, z, function='cubic')
zi = rbf(xi, yi)

if __name__ == "__main__":
    # Visualize
    #%%
    plt.scatter(xi, yi, c=zi, cmap='jet')
    cb = plt.colorbar()
    cb.set_label('Efficiency', loc='center')
    plt.scatter(x, y, c='k', marker="+", s=30)
    plt.xlabel(r"Flow Coefficient ($\phi$)")
    plt.ylabel(r"Loading Coefficient ($\Psi$)")
    plt.title("Smith chart")
    # plt.show()
    plt.rcParams['figure.dpi'] = 500
    fig, ax = plt.subplots()
    CS = ax.contour(xi, yi, zi, levels=[0.87, 0.88, 0.89, 0.90, 0.91, 0.92, 0.93, 0.94], cmap="twilight_shifted")
    ax.clabel(CS, inline=True, fontsize=10)
    # ax.scatter(xi, yi, c=zi, cmap='jet')
    plt.xlabel(r"Flow Coefficient ($\phi$)", fontsize=16)
    plt.ylabel(r"Loading Coefficient ($\Psi$)", fontsize=16)
    plt.grid()
    plt.show()
